"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/generate-card";
exports.ids = ["pages/api/generate-card"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-card&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fgenerate-card.ts&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-card&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fgenerate-card.ts&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_generate_card_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/pages/api/generate-card.ts */ \"(api-node)/./src/pages/api/generate-card.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_generate_card_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_generate_card_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/generate-card\",\n        pathname: \"/api/generate-card\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_generate_card_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGZ2VuZXJhdGUtY2FyZCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnNyYyUyRnBhZ2VzJTJGYXBpJTJGZ2VuZXJhdGUtY2FyZC50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDRTtBQUMxRDtBQUM2RDtBQUM3RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsNERBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLDREQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLHlHQUFtQjtBQUNsRDtBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vc3JjL3BhZ2VzL2FwaS9nZW5lcmF0ZS1jYXJkLnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9nZW5lcmF0ZS1jYXJkXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZ2VuZXJhdGUtY2FyZFwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-card&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fgenerate-card.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./src/pages/api/generate-card.ts":
/*!****************************************!*\
  !*** ./src/pages/api/generate-card.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sharp */ \"sharp\");\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(sharp__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nasync function handler(req, res) {\n    if (req.method !== 'POST') {\n        return res.status(405).json({\n            message: 'Method Not Allowed'\n        });\n    }\n    const { userName, isClubMember } = req.body;\n    if (!userName || typeof isClubMember === 'undefined') {\n        return res.status(400).json({\n            message: 'Missing parameters'\n        });\n    }\n    try {\n        const imageDir = isClubMember ? 'ai' : 'others';\n        const directoryPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), 'public', imageDir);\n        // Get list of image files in the directory\n        const files = await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().readdir(directoryPath);\n        const imageFiles = files.filter((file)=>{\n            const lowerCaseFile = file.toLowerCase();\n            return lowerCaseFile.endsWith('.jpg') || lowerCaseFile.endsWith('.jpeg') || lowerCaseFile.endsWith('.png');\n        });\n        if (imageFiles.length === 0) {\n            return res.status(404).json({\n                message: `No image files found in ${imageDir} directory.`\n            });\n        }\n        // Select a random image file\n        const randomImageName = imageFiles[Math.floor(Math.random() * imageFiles.length)];\n        const imagePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(directoryPath, randomImageName);\n        // Check if the image file exists (redundant after readdir but good practice)\n        try {\n            await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().access(imagePath);\n        } catch (error) {\n            console.error(`Image file not found: ${imagePath}`, error);\n            return res.status(404).json({\n                message: 'Selected background image not found.'\n            });\n        }\n        let image = sharp__WEBPACK_IMPORTED_MODULE_0___default()(imagePath);\n        const metadata = await image.metadata();\n        // Calculate text position (closer to the top for header)\n        const textYPercentage = 15; // Position at 15% of the height from the top\n        const textY = metadata.height * textYPercentage / 100;\n        // SVG for text overlay\n        const svgText = `\n      <svg width=\"${metadata.width}\" height=\"${metadata.height}\">\n        <style>\n          .title { fill: #ffffff; font-size: 60px; font-weight: bold; text-anchor: middle; font-family: 'Noto Sans Arabic', sans-serif; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); }\n        </style>\n        <text x=\"50%\" y=\"${textY}\" class=\"title\">${userName}</text>\n      </svg>\n    `;\n        const svgBuffer = Buffer.from(svgText);\n        const compositeLayers = [\n            {\n                input: svgBuffer,\n                gravity: 'northwest',\n                top: 0,\n                left: 0\n            }\n        ];\n        // Add logo if the user is a club member\n        if (isClubMember) {\n            const logoPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), 'public', 'logo.png');\n            try {\n                await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().access(logoPath);\n                const logoBuffer = await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().readFile(logoPath);\n                // Resize logo if needed and calculate position\n                const logo = sharp__WEBPACK_IMPORTED_MODULE_0___default()(logoBuffer).resize({\n                    width: 100\n                }); // Adjust size as needed\n                const logoMetadata = await logo.metadata();\n                const logoX = (metadata.width - logoMetadata.width) / 2; // Center horizontally\n                const logoY = 20; // Position 20px from the top (adjust as needed)\n                compositeLayers.push({\n                    input: await logo.toBuffer(),\n                    top: logoY,\n                    left: logoX\n                });\n            } catch (logoError) {\n                console.error('Logo file not found or error processing logo:', logoError);\n            // Optionally, you can still proceed without the logo or send an error\n            }\n        }\n        const finalImageBuffer = await image.composite(compositeLayers).png().toBuffer();\n        res.setHeader('Content-Type', 'image/png');\n        res.status(200).send(finalImageBuffer);\n    } catch (error) {\n        console.error('Error generating card:', error);\n        res.status(500).json({\n            message: 'Error generating card'\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9wYWdlcy9hcGkvZ2VuZXJhdGUtY2FyZC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQzBCO0FBQ0Y7QUFDSztBQUVkLGVBQWVHLFFBQzVCQyxHQUFtQixFQUNuQkMsR0FBb0I7SUFFcEIsSUFBSUQsSUFBSUUsTUFBTSxLQUFLLFFBQVE7UUFDekIsT0FBT0QsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxTQUFTO1FBQXFCO0lBQzlEO0lBRUEsTUFBTSxFQUFFQyxRQUFRLEVBQUVDLFlBQVksRUFBRSxHQUFHUCxJQUFJUSxJQUFJO0lBRTNDLElBQUksQ0FBQ0YsWUFBWSxPQUFPQyxpQkFBaUIsYUFBYTtRQUNwRCxPQUFPTixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLFNBQVM7UUFBcUI7SUFDOUQ7SUFFQSxJQUFJO1FBQ0YsTUFBTUksV0FBV0YsZUFBZSxPQUFPO1FBQ3ZDLE1BQU1HLGdCQUFnQmIsZ0RBQVMsQ0FBQ2UsUUFBUUMsR0FBRyxJQUFJLFVBQVVKO1FBRXpELDJDQUEyQztRQUMzQyxNQUFNSyxRQUFRLE1BQU1oQiwwREFBVSxDQUFDWTtRQUMvQixNQUFNTSxhQUFhRixNQUFNRyxNQUFNLENBQUNDLENBQUFBO1lBQzlCLE1BQU1DLGdCQUFnQkQsS0FBS0UsV0FBVztZQUN0QyxPQUFPRCxjQUFjRSxRQUFRLENBQUMsV0FBV0YsY0FBY0UsUUFBUSxDQUFDLFlBQVlGLGNBQWNFLFFBQVEsQ0FBQztRQUNyRztRQUVBLElBQUlMLFdBQVdNLE1BQU0sS0FBSyxHQUFHO1lBQzNCLE9BQU9yQixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxTQUFTLENBQUMsd0JBQXdCLEVBQUVJLFNBQVMsV0FBVyxDQUFDO1lBQUM7UUFDMUY7UUFFQSw2QkFBNkI7UUFDN0IsTUFBTWMsa0JBQWtCUCxVQUFVLENBQUNRLEtBQUtDLEtBQUssQ0FBQ0QsS0FBS0UsTUFBTSxLQUFLVixXQUFXTSxNQUFNLEVBQUU7UUFDakYsTUFBTUssWUFBWTlCLGdEQUFTLENBQUNhLGVBQWVhO1FBRTNDLDZFQUE2RTtRQUM3RSxJQUFJO1lBQ0YsTUFBTXpCLHlEQUFTLENBQUM2QjtRQUNsQixFQUFFLE9BQU9FLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLENBQUMsc0JBQXNCLEVBQUVGLFdBQVcsRUFBRUU7WUFDcEQsT0FBTzVCLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLFNBQVM7WUFBdUM7UUFDaEY7UUFFQSxJQUFJMEIsUUFBUW5DLDRDQUFLQSxDQUFDK0I7UUFDbEIsTUFBTUssV0FBVyxNQUFNRCxNQUFNQyxRQUFRO1FBRXJDLHlEQUF5RDtRQUN6RCxNQUFNQyxrQkFBa0IsSUFBSSw2Q0FBNkM7UUFDekUsTUFBTUMsUUFBUSxTQUFVQyxNQUFNLEdBQUdGLGtCQUFtQjtRQUVwRCx1QkFBdUI7UUFDdkIsTUFBTUcsVUFBVSxDQUFDO2tCQUNILEVBQUVKLFNBQVNLLEtBQUssQ0FBQyxVQUFVLEVBQUVMLFNBQVNHLE1BQU0sQ0FBQzs7Ozt5QkFJdEMsRUFBRUQsTUFBTSxnQkFBZ0IsRUFBRTVCLFNBQVM7O0lBRXhELENBQUM7UUFFRCxNQUFNZ0MsWUFBWUMsT0FBT0MsSUFBSSxDQUFDSjtRQUU5QixNQUFNSyxrQkFBeUI7WUFDN0I7Z0JBQUVDLE9BQU9KO2dCQUFXSyxTQUFTO2dCQUFhQyxLQUFLO2dCQUFHQyxNQUFNO1lBQUU7U0FDM0Q7UUFFRCx3Q0FBd0M7UUFDeEMsSUFBSXRDLGNBQWM7WUFDaEIsTUFBTXVDLFdBQVdqRCxnREFBUyxDQUFDZSxRQUFRQyxHQUFHLElBQUksVUFBVTtZQUNwRCxJQUFJO2dCQUNGLE1BQU1mLHlEQUFTLENBQUNnRDtnQkFDaEIsTUFBTUMsYUFBYSxNQUFNakQsMkRBQVcsQ0FBQ2dEO2dCQUVyQywrQ0FBK0M7Z0JBQy9DLE1BQU1HLE9BQU9yRCw0Q0FBS0EsQ0FBQ21ELFlBQVlHLE1BQU0sQ0FBQztvQkFBRWIsT0FBTztnQkFBSSxJQUFJLHdCQUF3QjtnQkFDL0UsTUFBTWMsZUFBZSxNQUFNRixLQUFLakIsUUFBUTtnQkFFeEMsTUFBTW9CLFFBQVEsQ0FBQ3BCLFNBQVNLLEtBQUssR0FBR2MsYUFBYWQsS0FBSyxJQUFJLEdBQUcsc0JBQXNCO2dCQUMvRSxNQUFNZ0IsUUFBUSxJQUFJLGdEQUFnRDtnQkFFbEVaLGdCQUFnQmEsSUFBSSxDQUFDO29CQUNuQlosT0FBTyxNQUFNTyxLQUFLTSxRQUFRO29CQUMxQlgsS0FBS1M7b0JBQ0xSLE1BQU1PO2dCQUNSO1lBRUYsRUFBRSxPQUFPSSxXQUFXO2dCQUNsQjFCLFFBQVFELEtBQUssQ0FBQyxpREFBaUQyQjtZQUMvRCxzRUFBc0U7WUFDeEU7UUFDRjtRQUVBLE1BQU1DLG1CQUFtQixNQUFNMUIsTUFDNUIyQixTQUFTLENBQUNqQixpQkFDVmtCLEdBQUcsR0FDSEosUUFBUTtRQUVYdEQsSUFBSTJELFNBQVMsQ0FBQyxnQkFBZ0I7UUFDOUIzRCxJQUFJRSxNQUFNLENBQUMsS0FBSzBELElBQUksQ0FBQ0o7SUFFdkIsRUFBRSxPQUFPNUIsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QzVCLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsU0FBUztRQUF3QjtJQUMxRDtBQUNGIiwic291cmNlcyI6WyIvaG9tZS9jYW5kaS9laWQtYWkvc3JjL3BhZ2VzL2FwaS9nZW5lcmF0ZS1jYXJkLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IHNoYXJwIGZyb20gJ3NoYXJwJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzL3Byb21pc2VzJztcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihcbiAgcmVxOiBOZXh0QXBpUmVxdWVzdCxcbiAgcmVzOiBOZXh0QXBpUmVzcG9uc2Vcbikge1xuICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgbWVzc2FnZTogJ01ldGhvZCBOb3QgQWxsb3dlZCcgfSk7XG4gIH1cblxuICBjb25zdCB7IHVzZXJOYW1lLCBpc0NsdWJNZW1iZXIgfSA9IHJlcS5ib2R5O1xuXG4gIGlmICghdXNlck5hbWUgfHwgdHlwZW9mIGlzQ2x1Yk1lbWJlciA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiAnTWlzc2luZyBwYXJhbWV0ZXJzJyB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgaW1hZ2VEaXIgPSBpc0NsdWJNZW1iZXIgPyAnYWknIDogJ290aGVycyc7XG4gICAgY29uc3QgZGlyZWN0b3J5UGF0aCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAncHVibGljJywgaW1hZ2VEaXIpO1xuXG4gICAgLy8gR2V0IGxpc3Qgb2YgaW1hZ2UgZmlsZXMgaW4gdGhlIGRpcmVjdG9yeVxuICAgIGNvbnN0IGZpbGVzID0gYXdhaXQgZnMucmVhZGRpcihkaXJlY3RvcnlQYXRoKTtcbiAgICBjb25zdCBpbWFnZUZpbGVzID0gZmlsZXMuZmlsdGVyKGZpbGUgPT4ge1xuICAgICAgY29uc3QgbG93ZXJDYXNlRmlsZSA9IGZpbGUudG9Mb3dlckNhc2UoKTtcbiAgICAgIHJldHVybiBsb3dlckNhc2VGaWxlLmVuZHNXaXRoKCcuanBnJykgfHwgbG93ZXJDYXNlRmlsZS5lbmRzV2l0aCgnLmpwZWcnKSB8fCBsb3dlckNhc2VGaWxlLmVuZHNXaXRoKCcucG5nJyk7XG4gICAgfSk7XG5cbiAgICBpZiAoaW1hZ2VGaWxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IG1lc3NhZ2U6IGBObyBpbWFnZSBmaWxlcyBmb3VuZCBpbiAke2ltYWdlRGlyfSBkaXJlY3RvcnkuYCB9KTtcbiAgICB9XG5cbiAgICAvLyBTZWxlY3QgYSByYW5kb20gaW1hZ2UgZmlsZVxuICAgIGNvbnN0IHJhbmRvbUltYWdlTmFtZSA9IGltYWdlRmlsZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogaW1hZ2VGaWxlcy5sZW5ndGgpXTtcbiAgICBjb25zdCBpbWFnZVBhdGggPSBwYXRoLmpvaW4oZGlyZWN0b3J5UGF0aCwgcmFuZG9tSW1hZ2VOYW1lKTtcblxuICAgIC8vIENoZWNrIGlmIHRoZSBpbWFnZSBmaWxlIGV4aXN0cyAocmVkdW5kYW50IGFmdGVyIHJlYWRkaXIgYnV0IGdvb2QgcHJhY3RpY2UpXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGZzLmFjY2VzcyhpbWFnZVBhdGgpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBJbWFnZSBmaWxlIG5vdCBmb3VuZDogJHtpbWFnZVBhdGh9YCwgZXJyb3IpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgbWVzc2FnZTogJ1NlbGVjdGVkIGJhY2tncm91bmQgaW1hZ2Ugbm90IGZvdW5kLicgfSk7XG4gICAgfVxuXG4gICAgbGV0IGltYWdlID0gc2hhcnAoaW1hZ2VQYXRoKTtcbiAgICBjb25zdCBtZXRhZGF0YSA9IGF3YWl0IGltYWdlLm1ldGFkYXRhKCk7XG5cbiAgICAvLyBDYWxjdWxhdGUgdGV4dCBwb3NpdGlvbiAoY2xvc2VyIHRvIHRoZSB0b3AgZm9yIGhlYWRlcilcbiAgICBjb25zdCB0ZXh0WVBlcmNlbnRhZ2UgPSAxNTsgLy8gUG9zaXRpb24gYXQgMTUlIG9mIHRoZSBoZWlnaHQgZnJvbSB0aGUgdG9wXG4gICAgY29uc3QgdGV4dFkgPSAobWV0YWRhdGEuaGVpZ2h0ICogdGV4dFlQZXJjZW50YWdlKSAvIDEwMDtcblxuICAgIC8vIFNWRyBmb3IgdGV4dCBvdmVybGF5XG4gICAgY29uc3Qgc3ZnVGV4dCA9IGBcbiAgICAgIDxzdmcgd2lkdGg9XCIke21ldGFkYXRhLndpZHRofVwiIGhlaWdodD1cIiR7bWV0YWRhdGEuaGVpZ2h0fVwiPlxuICAgICAgICA8c3R5bGU+XG4gICAgICAgICAgLnRpdGxlIHsgZmlsbDogI2ZmZmZmZjsgZm9udC1zaXplOiA2MHB4OyBmb250LXdlaWdodDogYm9sZDsgdGV4dC1hbmNob3I6IG1pZGRsZTsgZm9udC1mYW1pbHk6ICdOb3RvIFNhbnMgQXJhYmljJywgc2Fucy1zZXJpZjsgdGV4dC1zaGFkb3c6IDJweCAycHggNHB4IHJnYmEoMCwgMCwgMCwgMC41KTsgfVxuICAgICAgICA8L3N0eWxlPlxuICAgICAgICA8dGV4dCB4PVwiNTAlXCIgeT1cIiR7dGV4dFl9XCIgY2xhc3M9XCJ0aXRsZVwiPiR7dXNlck5hbWV9PC90ZXh0PlxuICAgICAgPC9zdmc+XG4gICAgYDtcblxuICAgIGNvbnN0IHN2Z0J1ZmZlciA9IEJ1ZmZlci5mcm9tKHN2Z1RleHQpO1xuXG4gICAgY29uc3QgY29tcG9zaXRlTGF5ZXJzOiBhbnlbXSA9IFtcbiAgICAgIHsgaW5wdXQ6IHN2Z0J1ZmZlciwgZ3Jhdml0eTogJ25vcnRod2VzdCcsIHRvcDogMCwgbGVmdDogMCB9XG4gICAgXTtcblxuICAgIC8vIEFkZCBsb2dvIGlmIHRoZSB1c2VyIGlzIGEgY2x1YiBtZW1iZXJcbiAgICBpZiAoaXNDbHViTWVtYmVyKSB7XG4gICAgICBjb25zdCBsb2dvUGF0aCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAncHVibGljJywgJ2xvZ28ucG5nJyk7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBmcy5hY2Nlc3MobG9nb1BhdGgpO1xuICAgICAgICBjb25zdCBsb2dvQnVmZmVyID0gYXdhaXQgZnMucmVhZEZpbGUobG9nb1BhdGgpO1xuICAgICAgICBcbiAgICAgICAgLy8gUmVzaXplIGxvZ28gaWYgbmVlZGVkIGFuZCBjYWxjdWxhdGUgcG9zaXRpb25cbiAgICAgICAgY29uc3QgbG9nbyA9IHNoYXJwKGxvZ29CdWZmZXIpLnJlc2l6ZSh7IHdpZHRoOiAxMDAgfSk7IC8vIEFkanVzdCBzaXplIGFzIG5lZWRlZFxuICAgICAgICBjb25zdCBsb2dvTWV0YWRhdGEgPSBhd2FpdCBsb2dvLm1ldGFkYXRhKCk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBsb2dvWCA9IChtZXRhZGF0YS53aWR0aCAtIGxvZ29NZXRhZGF0YS53aWR0aCkgLyAyOyAvLyBDZW50ZXIgaG9yaXpvbnRhbGx5XG4gICAgICAgIGNvbnN0IGxvZ29ZID0gMjA7IC8vIFBvc2l0aW9uIDIwcHggZnJvbSB0aGUgdG9wIChhZGp1c3QgYXMgbmVlZGVkKVxuXG4gICAgICAgIGNvbXBvc2l0ZUxheWVycy5wdXNoKHtcbiAgICAgICAgICBpbnB1dDogYXdhaXQgbG9nby50b0J1ZmZlcigpLFxuICAgICAgICAgIHRvcDogbG9nb1ksXG4gICAgICAgICAgbGVmdDogbG9nb1gsXG4gICAgICAgIH0pO1xuXG4gICAgICB9IGNhdGNoIChsb2dvRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignTG9nbyBmaWxlIG5vdCBmb3VuZCBvciBlcnJvciBwcm9jZXNzaW5nIGxvZ286JywgbG9nb0Vycm9yKTtcbiAgICAgICAgLy8gT3B0aW9uYWxseSwgeW91IGNhbiBzdGlsbCBwcm9jZWVkIHdpdGhvdXQgdGhlIGxvZ28gb3Igc2VuZCBhbiBlcnJvclxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGZpbmFsSW1hZ2VCdWZmZXIgPSBhd2FpdCBpbWFnZVxuICAgICAgLmNvbXBvc2l0ZShjb21wb3NpdGVMYXllcnMpXG4gICAgICAucG5nKClcbiAgICAgIC50b0J1ZmZlcigpO1xuXG4gICAgcmVzLnNldEhlYWRlcignQ29udGVudC1UeXBlJywgJ2ltYWdlL3BuZycpO1xuICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKGZpbmFsSW1hZ2VCdWZmZXIpO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2VuZXJhdGluZyBjYXJkOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6ICdFcnJvciBnZW5lcmF0aW5nIGNhcmQnIH0pO1xuICB9XG59ICJdLCJuYW1lcyI6WyJzaGFycCIsInBhdGgiLCJmcyIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsInVzZXJOYW1lIiwiaXNDbHViTWVtYmVyIiwiYm9keSIsImltYWdlRGlyIiwiZGlyZWN0b3J5UGF0aCIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwiZmlsZXMiLCJyZWFkZGlyIiwiaW1hZ2VGaWxlcyIsImZpbHRlciIsImZpbGUiLCJsb3dlckNhc2VGaWxlIiwidG9Mb3dlckNhc2UiLCJlbmRzV2l0aCIsImxlbmd0aCIsInJhbmRvbUltYWdlTmFtZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImltYWdlUGF0aCIsImFjY2VzcyIsImVycm9yIiwiY29uc29sZSIsImltYWdlIiwibWV0YWRhdGEiLCJ0ZXh0WVBlcmNlbnRhZ2UiLCJ0ZXh0WSIsImhlaWdodCIsInN2Z1RleHQiLCJ3aWR0aCIsInN2Z0J1ZmZlciIsIkJ1ZmZlciIsImZyb20iLCJjb21wb3NpdGVMYXllcnMiLCJpbnB1dCIsImdyYXZpdHkiLCJ0b3AiLCJsZWZ0IiwibG9nb1BhdGgiLCJsb2dvQnVmZmVyIiwicmVhZEZpbGUiLCJsb2dvIiwicmVzaXplIiwibG9nb01ldGFkYXRhIiwibG9nb1giLCJsb2dvWSIsInB1c2giLCJ0b0J1ZmZlciIsImxvZ29FcnJvciIsImZpbmFsSW1hZ2VCdWZmZXIiLCJjb21wb3NpdGUiLCJwbmciLCJzZXRIZWFkZXIiLCJzZW5kIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./src/pages/api/generate-card.ts\n");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "sharp":
/*!************************!*\
  !*** external "sharp" ***!
  \************************/
/***/ ((module) => {

module.exports = require("sharp");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-card&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fgenerate-card.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();